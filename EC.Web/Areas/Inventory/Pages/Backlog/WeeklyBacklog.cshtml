@page
@model WeeklyBacklogModel
@{
}
<h2>Weekly Backlogs</h2>
@*<form method="post" enctype="multipart/form-data">
    <div class="row">
        <div class="col-md-4">
            @if (Model.Weeklybacklogs.Count() > 0)
            {
                <button class="btn btn-outline-primary btn-sm" asp-page-handler="Export">Export</button>
            }
        </div>
        <div class="col-md-8"></div>
    </div>
</form>*@
<table id="example" class="table table-striped table-hover table-bordered">
    <thead>
        <tr>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].OrdDate)
            </th>
            <th class="text-right">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].SONumber)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].ShipDate)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].Sales)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].InsideSales)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].Rep)
            </th>
            <th class="text-right">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].RepComm)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].Customer)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].CustPONumber)
            </th>
            <th class="text-right">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].Ln)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].ModelNumber)
            </th>
            <th class="text-right">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].OpenQty)
            </th>
            <th class="text-right">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].Price)
            </th>
            <th class="text-right">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].OpenAmt)
            </th>
            <th class="text-left">
                @Html.DisplayNameFor(model => model.Weeklybacklogs[0].Notes)
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Weeklybacklogs)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.OrdDate)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.SONumber)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.ShipDate)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.Sales)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.InsideSales)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.Rep)
                </td>
                <td class="text-right">
                    @Html.DisplayFor(modelItem => item.RepComm)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.Customer)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.CustPONumber)
                </td>
                <td class="text-right">
                    @Html.DisplayFor(modelItem => item.Ln)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.ModelNumber)
                </td>
                <td class="text-right">
                    @Html.DisplayFor(modelItem => item.OpenQty)
                </td>
                <td class="text-right">
                    @Html.DisplayFor(modelItem => item.Price)
                </td>
                <td class="text-right">
                    @Html.DisplayFor(modelItem => item.OpenAmt)
                </td>
                <td class="text-left">
                    @Html.DisplayFor(modelItem => item.Notes)
                </td>
            </tr>
        }
    </tbody>
</table>
@section Scripts {
    <script>
        var idioma =
        {
            "sProcessing": "Processing...",
            "sLengthMenu": "To show _MENU_ registros",
            "sZeroRecords": "No results found",
            "sEmptyTable": "No data available in this table",
            "sInfo": "Showing records from _START_ to _END_ of a total of _TOTAL_ records",
            "sInfoEmpty": "Showing records from 0 to 0 of a total of 0 records",
            "sInfoFiltered": "(filtering a total of _MAX_ registros)",
            "sInfoPostFix": "",
            "sSearch": "Search for:",
            "sUrl": "",
            "sInfoThousands": ",",
            "sLoadingRecords": "Loading...",
            "oPaginate": {
                "sFirst": "First",
                "sLast": "Last",
                "sNext": "Next",
                "sPrevious": "Previous"
            },
            "oAria": {
                "sSortAscending": ": Sort as ascending",
                "sSortDescending": ": Sort as descending order"
            },
            "buttons": {
                "copyTitle": 'Copied information',
                "copyKeys": 'Use your keyboard or menu to select the copy command',
                "copySuccess": {
                    "_": '%d rows copied to clipboard',
                    "1": '1 row copied to clipboard'
                },

                "pageLength": {
                    "_": "To show %d rows",
                    "-1": "Show everything"
                }
            }
        };
        $(document).ready(function () {
            $('#example').DataTable({
                "paging": true,
                "lengthChange": true,
                "searching": true,
                "ordering": true,
                "info": true,
                "autoWidth": true,
                "language": idioma,
                "lengthMenu": [[5, 10, 20, -1], [5, 10, 20, "Show everything"]],
                dom: 'Bfrt<"col-md-6 inline"i> <"col-md-6 inline"p>',
                buttons: {
                    dom: {
                        container: {
                            tag: 'div',
                            className: 'flexcontent'
                        },
                        buttonLiner: {
                            tag: null
                        }
                    },
                    buttons: [
                        {
                            extend: 'copyHtml5',
                            text: '<i class="fa fa-clipboard"></i>Copy',
                            title: 'Copy table title',
                            titleAttr: 'Copy',
                            className: 'btn btn-app export barras',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                            }
                        },

                        {
                            extend: 'pdfHtml5',
                            text: '<i class="fa fa-file-pdf-o"></i>PDF',
                            title: 'Table title in pdf',
                            titleAttr: 'PDF',
                            className: 'btn btn-app export pdf',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                            },
                            customize: function (doc) {

                                doc.styles.title = {
                                    color: '#4c8aa0',
                                    fontSize: '30',
                                    alignment: 'center'
                                }
                                doc.styles['td:nth-child(2)'] = {
                                    width: '100px',
                                    'max-width': '100px'
                                },
                                    doc.styles.tableHeader = {
                                        fillColor: '#4c8aa0',
                                        color: 'white',
                                        alignment: 'center'
                                    },
                                    doc.content[1].margin = [100, 0, 100, 0]

                            }

                        },

                        {
                            extend: 'excelHtml5',
                            text: '<i class="fa fa-file-excel-o"></i>Excel',
                            title: 'Weekly Backlog',
                            titleAttr: 'Excel',
                            className: 'btn btn-app export excel',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                            },
                        },
                        {
                            extend: 'csvHtml5',
                            text: '<i class="fa fa-file-text-o"></i>CSV',
                            title: 'Table title in CSV',
                            titleAttr: 'CSV',
                            className: 'btn btn-app export csv',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                            }
                        },
                        {
                            extend: 'print',
                            text: '<i class="fa fa-print"></i>Print',
                            title: 'Title of table in print',
                            titleAttr: 'Imprimir',
                            className: 'btn btn-app export imprimir',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                            }
                        },
                        {
                            extend: 'pageLength',
                            titleAttr: 'Records to show',
                            className: 'selectTable'
                        }
                    ]


                }
            });
        });
    </script>
}
